#+TITLE: gnuplot
#+DATE: <2024-12-27 vie>

|--------+-------------------------------------------------------|
| home   | http://gnuplot.info/                                  |
| faq    | http://gnuplot.info/faq/index.html                    |
| wiki   | https://en.wikipedia.org/wiki/Gnuplot                 |
| wiki   | https://en.wikibooks.org/wiki/Gnuplot                 |
| online | https://hostcat.fhsu.edu/cdclark/static/apps/gnuplot/ |
|--------+-------------------------------------------------------|

- 1986
- Thomas Williams, Colin Kelley, Russell Lang, Dave Kotz, John Campbell, Gershon Elber, Alexander Woo
- ~/.gnuplot, gnuplotrc (system-wide)
- .gp extension

* cli

#+begin_src
  gnuplot [x11 options] [options] [scriptfile ...]
#+end_src

|-----------+----+------------+---------------------------------|
|           | -e | CMDS       |                                 |
|           | -c | FILE [ARG] | runs script S with given args   |
| --persist | -p | -          | keep window after plotting ends |
| --slow    | -s | -          | wait for slow font init         |
| --default | -d | -          | do NOT read ~/.gnuplot          |
|-----------+----+------------+---------------------------------|

* language

#+begin_src sh
  #!/usr/bin/gnuplot -persist
#+end_src

- has variable assignment
- "(/Symbol p)" - replaces parens with ùõë
- curve fitting https://www.youtube.com/watch?v=vHM_5AeKwXE
- do for [i=1:96] { plot f(x,i*0.1) }

** input data

- space separated by default
- putting 2 newlines one after another, separate different blocks/groups of data

** commands
|-------+------------------------------------+-----------------------------|
|   <r> |                                    |                             |
| unset | OPTION                             |                             |
|   set | OPTION [VALUE]                     |                             |
|  with | (l)ines[*], dots[.], lines(points) |                             |
|  show | variables                          |                             |
| stats | FILENAME name S                    | shows file field statistics |
|       |                                    | later can be referenced     |
|       |                                    | eg: S_min_x                 |
|-------+------------------------------------+-----------------------------|
*** plot

- [re]plot [PLOT_A OPTS], [PLOT_B OPTS]
  - "filename.txt"
  - /dev/stdin
  - using N:N+1:N+n
  - smooth [bezier¬¶mcsplines]
  - title (for legend box)
  - index N
    - reference block N of data (aka separated by 2 \n)
    - blocks index start at 0
  - with
    - linespoint
    - lines
      - linestyle N
      - linecolor rgb "#0b0000"
    - points
      - pointsize N
- imagesc - matrix/heatmap - 2d contour
- splot - 3d surface
- hist
- scatter3 - 3d points
** options (setteable)

*** general
#+CAPTION: S = a quoted string, N = a number
|--------------+-------------------+------------------------------------|
|     <c>      |        <c>        |                                    |
|              |     argument      | description                        |
|--------------+-------------------+------------------------------------|
|    border    |        [N]        | axis lines (takes the bitsum)      |
| [x¬¶y¬¶z]tics  | [nomirror¬¶rotate] | axis numbers                       |
|              |  START,STEP,END   |                                    |
|              |    (S N[,S N])    | custom labels S at point N         |
| [x¬¶y¬¶z]label |         S         | axis label                         |
|              |     offset N      |                                    |
| [x¬¶y¬¶z]range |       [N:N]       | axis range                         |
|     grid     |         -         | axis grid                          |
|     key      | [BLTR] [[no]box]  | enable/disable/position legend box |
|              |      width N      |                                    |
|              |      font S       | use ",14" to only change it's size |
|              |      at N,N       |                                    |
|--------------+-------------------+------------------------------------|
|   samples    |         N         | ????                               |
|    xdata     |       time        | tells x axis is a date/time        |
|   encoding   |       utf8        |                                    |
|   timefmt    |         S         | format of the INPUT date           |
|   datafile   |    separator S    | input separator (default: space)   |
|--------------+-------------------+------------------------------------|
|    title     |         S         | the                                |
|    format    |     [x¬¶y] FMT     | tic format string                  |
|    scale     |         N         |                                    |
|   logscale   |     [x¬¶y] [N]     | with step N                        |
|  autoscale   |    [[x¬¶y]fix]     | prevents autoextend of scale       |
|    output    |         S         | saves into filepath at S           |
|--------------+-------------------+------------------------------------|
|    pause     |         N         | seconds to pause                   |
|   +reread+   |         -         | REMOVED in 6.0 +reread input+      |
|--------------+-------------------+------------------------------------|
*** style

|------------------+---------------------------------|
| fill transparent |                                 |
| solid F          |                                 |
| noborder         |                                 |
| data lines       |                                 |
| line N           | can be later referenced on plot |
|------------------+---------------------------------|

#+CAPTION: gnuplot "test" command output
#+ATTR_HTML: :width 500
#+ATTR_ORG: :width 600
[[./test_page.png]]

*** term[inal]

- gif [animate¬¶delay]
- png [size¬¶font]
- pngcairo
- wxt
- xterm (xterm tektronix mode)
- dumb (aka ascii)

*** palette

http://gnuplot.info/demo/pm3dcolors.html

#+begin_src gnuplot
  set palette rgb 7,5,15
  set palette defined (0 0 0 0, 0.3 1 0 0, 0.6 "blue", 1 "#ffffff")
#+end_src

* snippets

- simple pipe
  #+begin_src sh
    $ gnuplot -p -e "plot '<cat'" < rawnumbers # opens qt window
    $ gnuplot -p -e "plot '-'"    < rawnumbers # opens qt window
    $ GNUTERM=dumb gnuplot -e "plot '-'"    < rawnumbers # ascii plot
  #+end_src

- stream - draw last 200 lines, ten times per second
  #+begin_src sh
   while (1) {
     plot "< tail -200 plot.dat" using 1:2 with lines
     pause 0.1
   }
  #+end_src

* examples

- https://github.com/TheFox/gnuplot-examples
- https://gnuplot.info/screenshots/index.html
- https://gnuplot.sourceforge.net/demo_5.4/

* tools

- wrapper: plot realtime and stored data from the cli https://github.com/dkogan/feedgnuplot
- config https://github.com/Gnuplotting/gnuplot-configs
- pallettes
  - https://github.com/Gnuplotting/gnuplot-palettes
  - https://github.com/aschn/gnuplot-colorbrewer

* gotchas

- by default wants *space* separated fields
- sizes are given in pixels, can be undesired when exporting at large dimensions
- plot field indexing starts at $1
- poor compiler messages
- different compiler messages when reading a script or from *-e*
- no *%a* date format for input parsing
- to read from stdin "-" might not work in plot (?
  - use /dev/stdin
